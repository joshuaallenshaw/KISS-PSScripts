# Module: Powershell script to clean IIS log files
function CleanTempLogfiles() {
    param ($FilePath)
    Foreach ($File in Get-ChildItem -Path $FilePath -File -ErrorAction SilentlyContinue) {
    if ($File.LastWriteTime -lt ($(Get-Date).Adddays(-$days))) {
            remove-item -path $File.FullName -force
            Write-Host "Removed logfile: " $File.FullName
        }
    }
}
$days=90
$Path="C:\inetpub\logs\LogFiles\W3SVC1","C:\inetpub\logs\LogFiles\W3SVC2","C:\inetpub\logs\LogFiles\W3SVC3"
Write-Host "Removing IIS-logs keeping last” $days "days"
CleanTempLogfiles($Path)

# SIG # Begin signature block
# MIIKOQYJKoZIhvcNAQcCoIIKKjCCCiYCAQExCzAJBgUrDgMCGgUAMGkGCisGAQQB
# gjcCAQSgWzBZMDQGCisGAQQBgjcCAR4wJgIDAQAABBAfzDtgWUsITrck0sYpfvNR
# AgEAAgEAAgEAAgEAAgEAMCEwCQYFKw4DAhoFAAQUtwNzq+YR+zB+aeAjUaDfK+0J
# kZ2gggeeMIIHmjCCBYKgAwIBAgITKQAAAIR9aRmpT/cLYAAAAAAAhDANBgkqhkiG
# 9w0BAQsFADBNMRUwEwYKCZImiZPyLGQBGRYFbG9jYWwxGDAWBgoJkiaJk/IsZAEZ
# FghQSVBFLURPTTEaMBgGA1UEAxMRUElQRS1ET00tRENSSU8tQ0EwHhcNMTcwNjAx
# MTQ0OTMzWhcNMTgwNjAxMTQ0OTMzWjBfMRUwEwYKCZImiZPyLGQBGRYFbG9jYWwx
# GDAWBgoJkiaJk/IsZAEZFghQSVBFLURPTTETMBEGA1UECxMKUElQRSBVc2VyczEX
# MBUGA1UEAxMOSm9zaHVhIEEuIFNoYXcwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw
# ggEKAoIBAQC59Fx+Jqfinnv0n5KjNMDmXGHubKc7YRPqnXHP6tj4eS8sD4Q3RO6/
# XFjQeV1gtV+uNN9QCAJ2kq6CorPmsWs1xtBN1IRR3LzwGDV3VBBPEWsqNOvvqRQi
# pQwBohmRTTbcWqyyZAyLC3tZDWmIzHOtYPNhDvGrHXT1KaIQxlIOYOrp2sckKcgE
# zNJmVDQHtrBCp2i9fyrCzTA+SzpFf2W0G0JqzCy3wHDtn7MAXrdNPxXsfszXVimz
# nQ9mWIOqRKmr+KrR5fc7fqQmbjpc6x8e+nUy9u6KGR2SGTwFDMEjZZ/8wUkcMPQM
# A5ex/j7Lwd4lkNVrazu2TQ7+ucXxN9edAgMBAAGjggNfMIIDWzA8BgkrBgEEAYI3
# FQcELzAtBiUrBgEEAYI3FQiB/J0IgdqwH+WDD8KjWYeBn0iBP4b87nSHsoUrAgFm
# AgEAMBMGA1UdJQQMMAoGCCsGAQUFBwMDMA4GA1UdDwEB/wQEAwIHgDAbBgkrBgEE
# AYI3FQoEDjAMMAoGCCsGAQUFBwMDMB0GA1UdDgQWBBQH6aRmsNePpwPcQ2RbaTEx
# W0aapzAfBgNVHSMEGDAWgBRuZmeE+ha/1B9XGZ2TtP3IvtKERTCCARMGA1UdHwSC
# AQowggEGMIIBAqCB/6CB/IaBu2xkYXA6Ly8vQ049UElQRS1ET00tRENSSU8tQ0Es
# Q049RENSSU8wMSxDTj1DRFAsQ049UHVibGljJTIwS2V5JTIwU2VydmljZXMsQ049
# U2VydmljZXMsQ049Q29uZmlndXJhdGlvbixEQz1QSVBFLURPTSxEQz1sb2NhbD9j
# ZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0P2Jhc2U/b2JqZWN0Q2xhc3M9Y1JMRGlz
# dHJpYnV0aW9uUG9pbnSGPGh0dHA6Ly9kY3JpbzAxLnBpcGUtZG9tLmxvY2FsL0Nl
# cnREYXRhL1BJUEUtRE9NLURDUklPLUNBLmNybDCCASkGCCsGAQUFBwEBBIIBGzCC
# ARcwgbMGCCsGAQUFBzAChoGmbGRhcDovLy9DTj1QSVBFLURPTS1EQ1JJTy1DQSxD
# Tj1BSUEsQ049UHVibGljJTIwS2V5JTIwU2VydmljZXMsQ049U2VydmljZXMsQ049
# Q29uZmlndXJhdGlvbixEQz1QSVBFLURPTSxEQz1sb2NhbD9jQUNlcnRpZmljYXRl
# P2Jhc2U/b2JqZWN0Q2xhc3M9Y2VydGlmaWNhdGlvbkF1dGhvcml0eTBfBggrBgEF
# BQcwAoZTaHR0cDovL2RjcmlvMDEucGlwZS1kb20ubG9jYWwvQ2VydERhdGEvRENS
# SU8wMS5QSVBFLURPTS5sb2NhbF9QSVBFLURPTS1EQ1JJTy1DQS5jcnQwVQYDVR0R
# BE4wTKAsBgorBgEEAYI3FAIDoB4MHEpTaGF3QHBpZWRtb250cGVkaWF0cmljcy5u
# ZXSBHGpzaGF3QHBpZWRtb250cGVkaWF0cmljcy5uZXQwDQYJKoZIhvcNAQELBQAD
# ggIBAAEPLWJ4glWpe95jjOKMLKtoneYPcJelcb2pjKCwardkFRMM4MUjTHqsj4Au
# OLsRCLWeXMC67OqneugFDXSOFa1Fd0DYn02bKSa7Eedi2XDU/HyONvaxaf3btw48
# MMXd32JE4Ii9q8X1X4XoMw4BQfBOSLLTGc0DRgYkE4fQepxOH8PZOGRMA0Ckjau9
# kZ4u8xX03MwfOEDMXqjrWAstq4c2kcqoVGJDG+bEonqvBbQlLmaFRITq+sr7tPzQ
# k24E5LGf57aJF/r2W3hzaDKwcT5nVnSFk7IM44oavkdqpZ/knAUeLCyPN8+02V0H
# iMUbUqh4JXQ/IakygK04gBsH9o3eKnJLmrwXPsQc/M7DkMeSYyVDZuYsHHGqSOlB
# ZcFYEWe9kYTNWlxuQJwidTXwnHx+gBBjqbioQ0PYUe6kUPA5RE2cL2wOjtwRtnK+
# YmA/JLrjEvHc5+uqT6G4cpS8Pqv5WM+VGslUiGttiCD10+U3Pt5Ph9LJ/2Ew9qHX
# qBgZYACHVFg/ywNHm2tQ0hWU+DSP2jCCuUAaDUpwrd1//fT+0liuD885u2xFLENS
# sl2JQgnMN2gVE6oAvq3x1V7aUNr7BqdtXDNVwd5I9RYtFtFSUFjxlNPxa8bgkBiN
# d59VHirlsE0upWDy/A2HpPDBH+q37UpCpJlFJJxNahRB3GRwMYICBTCCAgECAQEw
# ZDBNMRUwEwYKCZImiZPyLGQBGRYFbG9jYWwxGDAWBgoJkiaJk/IsZAEZFghQSVBF
# LURPTTEaMBgGA1UEAxMRUElQRS1ET00tRENSSU8tQ0ECEykAAACEfWkZqU/3C2AA
# AAAAAIQwCQYFKw4DAhoFAKB4MBgGCisGAQQBgjcCAQwxCjAIoAKAAKECgAAwGQYJ
# KoZIhvcNAQkDMQwGCisGAQQBgjcCAQQwHAYKKwYBBAGCNwIBCzEOMAwGCisGAQQB
# gjcCARUwIwYJKoZIhvcNAQkEMRYEFP/Xf9FBvsPhqp0x7NZvkxFJYoPHMA0GCSqG
# SIb3DQEBAQUABIIBABdIBLzBCF+SV9GL82TICJR1S/qjAVz9lLL/nwW3SPHOzpOl
# 61RmlzdIvD1y0kOkToiXPGKYKi47QPEfwT6hJPW1jykf9izVbRZcEJw1nYR+yyIW
# l3vbmT/PUJMAk7FHahU69DUgLqVQ4tdte4EvbIQIZHWimJPADktOggZVc7BUUisE
# UjT2QCpzr9L2K2b8L/trOYrvMUdezEVHFL8NIESMnvhzUiLsU0MCttbWyfKl21pw
# pqCYc/8XEllhv915TQS4hrSNe8z9S9WnrE842mrFlZ+0Ji8dbOj5CyqXeTGJUkFh
# 6nWXY3niG5shp3YkiOawf5WYuh9NlPGZ6TQZqUg=
# SIG # End signature block
